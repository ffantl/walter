#!/usr/bin/env perl

use diagnostics;

use Module::Load;

use Data::Dumper;

use File::Slurp qw(read_file);

my $confdir = $ENV{"HOME"} . "/.walter/";

if (!(-d $confdir))
{
    mkdir($confdir);
}

if (@ARGV)
{

    unshift(@INC, ".");
    my %mappings = ();

    my @modules = split(" ", read_file("walter.mods"));

    
    foreach my $mod (@modules)
    {
        autoload $mod;
        init(\%mappings);
    }
    
    my $verb = shift(@ARGV);
    my $handler = $mappings{$verb};
    &$handler(@ARGV);
}
